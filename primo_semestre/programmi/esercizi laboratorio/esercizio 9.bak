;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-intermediate-lambda-reader.ss" "lang")((modname |esercizio 9|) (read-case-sensitive #t) (teachpacks ((lib "hanoi.ss.txt" "installed-teachpacks") (lib "drawings.ss.txt" "installed-teachpacks"))) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ((lib "hanoi.ss.txt" "installed-teachpacks") (lib "drawings.ss.txt" "installed-teachpacks")) #f)))
;problema 9
;9 e 10 dicembre 2024

(define ALFABETO  ;65-88 (no 74 75 85 87)
  (list "A" "B" "C" "D" "E" "F" "G" "H" "I" "L" "M" "N" "O" "P" "Q" "R" "S" "T" "V" "X") ;convenzione: da 0 a 19
  )
(define alfabeto  ;65-88 (no 74 75 85 87)
  (list "a" "b" "c" "d" "e" "f" "g" "h" "i" "l" "m" "n" "o" "p" "q" "r" "s" "t" "v" "x") ;convenzione: da 40 a 59
  )

(define trova-pos
  (lambda (a b x)
    (cond [(null? b) a]
          [(and(member a ALFABETO)(equal? a (car b))) (cond[(and(>= x 0)(<= x 19))x]
                                                            [(and(>= x 0)(>= x 19))(trova-pos a b(- x 20))]
                                                            [(< x 0)(trova-pos a b(+ x 20))]
                                                            )]
          [(and(member a alfabeto)(equal? a (car b))) (cond[(and(>= x 40)(<= x 59))x]
                                                            [(and(>= x 40)(>= x 59))(trova-pos a b(- x 20))]
                                                            [(< x 40)(trova-pos a b(+ x 20))]
                                                            )]

          [else(trova-pos a (cdr b) (+ 1 x)
                       )]
    )))

(define cifra
  (lambda (in alf x n)
    (if (null? in) (decifra x '())
        (let* ((pos (trova-pos (car in) alf n))
               (new-x (append x (list pos))))
          (cifra (cdr in) alf new-x n)))))

(define crittazione-cesare
  (lambda (input n)
    (cifra (explode input) (append alfabeto ALFABETO) '() n)
    ))

;(explode "cat")
;(list "c" "a" "t")

(define decifra
  (lambda (input out)
    (if (null? input)(reverse out)
        (decifra (cdr input)(cons (trova-pos(car input)'() 0) out))
        )
    
   ))

(define decodifica
  (lambda (a)
    (if  (null? a) null
    (let ((x (car a)))
    (cond 
          ((not(and(member a ALFABETO)(member a alfabeto))) (cons (car a) (decodifica (cdr a))))
          ((and(>= x 0)(<= x 19)) (cons (list-ref ALFABETO x)(decodifica (cdr a))))
          ((and(>= x 40)(<= x 59)) (cons (list-ref alfabeto (- x 40))(decodifica (cdr a))) )

                 
          )
           ))
    )
  )
  


    

(define conta-lung
  (lambda (in out)
    (if(null? in)out
       (conta-lung (cdr in) (+ 1 out)
                   )
       )
    ))